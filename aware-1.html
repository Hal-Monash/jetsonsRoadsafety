<!DOCTYPE html>
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<title>Find Place - Keep Safe</title>
		<meta name="description" content="Worthy a Bootstrap-based, Responsive HTML5 Template">
		<meta name="author" content="htmlcoder.me">

		<!-- Mobile Meta -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Favicon -->
		<link rel="shortcut icon" href="images/favicon.ico">

		<!-- Web Fonts -->
		<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700,300&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'>
		<link href='http://fonts.googleapis.com/css?family=Raleway:700,400,300' rel='stylesheet' type='text/css'>

		<!-- Bootstrap core CSS -->
		<link href="bootstrap/css/bootstrap.css" rel="stylesheet">

		<!-- Font Awesome CSS -->
		<link href="fonts/font-awesome/css/font-awesome.css" rel="stylesheet">

		<!-- Plugins -->
		<link href="css/animations.css" rel="stylesheet">

		<!-- Worthy core CSS file -->
		<link href="css/style.css" rel="stylesheet">

		<!-- Custom css -->
		<link href="css/custom.css" rel="stylesheet">
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

	</head>

	<body class="no-trans">
		<!-- scrollToTop -->
		<!-- ================ -->
		<div class="scrollToTop"><i class="icon-up-open-big"></i></div>

		<!-- header start -->
		<!-- ================ -->
		<header class="header fixed clearfix navbar navbar-fixed-top">
			<div class="container">
				<div class="row">
					<div class="col-md-4">

						<!-- header-left start -->
						<!-- ================ -->
						<div class="header-left clearfix">

							<!-- logo -->

							<!-- name-and-slogan -->
							<div class="site-name-and-slogan smooth-scroll">
								<div class="site-name"><a href="#banner">KEEP SAFE</a></div>
							</div>

						</div>
						<!-- header-left end -->

					</div>
					<div class="col-md-8">

						<!-- header-right start -->
						<!-- ================ -->
						<div class="header-right clearfix">

							<!-- main-navigation start -->
							<!-- ================ -->
							<div class="main-navigation animated">

								<!-- navbar start -->
								<!-- ================ -->
								<nav class="navbar navbar-default" role="navigation">
									<div class="container-fluid">

										<!-- Toggle get grouped for better mobile display -->
										<div class="navbar-header">
											<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
												<span class="sr-only">Toggle navigation</span>
												<span class="icon-bar"></span>
												<span class="icon-bar"></span>
												<span class="icon-bar"></span>
											</button>
										</div>

										<!-- Collect the nav links, forms, and other content for toggling -->
										<div class="collapse navbar-collapse scrollspy smooth-scroll" id="navbar-collapse-1">
											<ul class="nav navbar-nav navbar-right">
												<li class="active"><a href="index.html">Home</a></li>
												<li><a href="info.html">GET INFORMED</a></li>
												<li><a href="aware-1.html">FIND PLACE</a></li>
												<li><a href="aware.html">CHECK YOUR TRIP</a></li>
												<li><a href="contact.html">CONTACT</a></li>
											</ul>
										</div>

									</div>
								</nav>
								<!-- navbar end -->

							</div>
							<!-- main-navigation end -->

						</div>
						<!-- header-right end -->

					</div>
				</div>
			</div>
		</header>
		<!-- header end -->

		<!-- banner start -->
		<!-- ================ -->
		<div id="banner" class="banner">
			<div class="banner-image-aware"></div>
			<div class="banner-caption">
				<div class="container">
					<div class="row">
						<div class="col-md-8 col-md-offset-2 object-non-visible" data-animation-effect="fadeIn">
							<h1 class="text-center">FIND PLACE TO PRACTISE DRIVING</h1>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- banner end -->

		<div class="default-bg space">
			<div class="container">
				<div class="row">
						<h3 class="text-center">You can find a plce to pratise driving within 10 or 20 miles from the entered location</h3>
						<h3 class="text-center">OR</h3>
						<h3 class="text-center">You can choose a place without any disturbing things to pra driving</h3>
				</div>
			</div>
		</div>

		<div class="space"></div>
		<div class="container">
			<div class="row">
				<h2 class="text-center">FIND PLACE</h2>
				<div class="row">
					<div class="col-md-6"/>
      			<input type="text" id="startpoint" placeholder="Your location" width="80%" required/>
						<br/>
						<input type="radio" id="z2" name="radius">10 miles<br/>
						<input type="radio" id="z5" name="radius">20 miles<br/>
						<br/>
						<p>Any where I can practice?</p>
						<input type="radio" id="pra" name="vic">Suggested place(s) to practise driving<br/>
						<br/>
						<p>If you want to find a plcae yourself, your can see:<br/>Places near me can affect driving practice</p>
						<input type="radio" id="erc" name="vic">Emergency closed point<br/>
  					<input type="radio" id="rwe" name="vic">Closed lines due to Roadworks and Events<br/>
			<!--			<input type="radio" id="rwe" name="vic">Previous accidents<br/> -->
						<br/>
						<input class="btn btn-default" type="button" onClick="vis()" value="SEARCH" >
			</div>
				<div id="map" class="col-md-6"></div>
			</div>
		</div>
	</div>
	<script src="https://maps.googleapis.com/maps/api/js?&libraries=places,geometry"></script>

		<script>
		//-38.973,144.686,-37.848,145.36
		var map = new google.maps.Map(document.getElementById("map"), {
  					zoom: 10,
  					center: new google.maps.LatLng(-37.8136,144.9631),
  					mapTypeId: google.maps.MapTypeId.TERRAIN,
          	zoomControl: true,
          	zoomControlOptions: {
            position: google.maps.ControlPosition.LEFT_TOP
          },
          scaleControl: true,
          streetViewControl: true,
          streetViewControlOptions: {
              position: google.maps.ControlPosition.LEFT_TOP
          }
				});
				var LatLngercs=[];
				var LatLngrwes=[];
				var markers=[];
				var acciMarkers=[];
				var park=[];
				var begin=document.getElementById("startpoint");
		//		var dest=document.getElementById("endpoint");
				var option= {
    				componentRestrictions: {country: 'au'}
  			};
				var place;
				var autocompleteStart = new google.maps.places.Autocomplete(begin,option);
  //      var autocompleteEnd = new google.maps.places.Autocomplete(dest,option);
				autocompleteStart.addListener('place_changed', function() {
										place = autocompleteStart.getPlace();
									});
				var smalllat;//-38.973;
				var smalllng;//144.686;
				var biglat;//-37.848;
				var biglng;
				var lattemp1u;
				var lngtemp1u;
		function vis(){
			clearMarkers();
		var geocoder = new google.maps.Geocoder();
		var begintemp=document.getElementById("startpoint").value;
		if (begintemp.match(/^[a-zA-Z0-9,\s]{2,100}$/)==null){
			alert('Please enter an address name between 2-100 letters or use autorefill');
		}
		else{
			geocoder.geocode( { 'address': begintemp}, function(results, status) {
			if (status == google.maps.GeocoderStatus.OK) {
				lattemp1u = results[0].geometry.location.lat();
				lngtemp1u = results[0].geometry.location.lng();}
			});
			if (place.geometry) {
				lattemp1u=place.geometry.location.lat();
				lngtemp1u=place.geometry.location.lng();
			}
			var temp1=isNaN(lattemp1u);
			var temp2=isNaN(lngtemp1u);
			if (!temp1 && !temp2){
			var lattemp1=lattemp1u.toPrecision(5);
			var lngtemp1=lngtemp1u.toPrecision(5);
			var centerPoint=new google.maps.LatLng(lattemp1,lngtemp1);
			map.setCenter(centerPoint);
			var marker = new google.maps.Marker({
				position: centerPoint,
				icon: imaage,
				map: map});
				if(!document.getElementById('z5').checked){
					document.getElementById("z2").checked = true;
					map.setZoom(13);
				}
				if(document.getElementById('z5').checked){
					map.setZoom(11);}
//		var accuracy = 5;
//		var circle = new google.maps.Circle({
//                 center: map.getCenter(),
//                 radius: accuracy
//             });
//		var bounds = circle.getBounds();
				var bounds = map.getBounds();
				var ne = bounds.getNorthEast();
				var sw = bounds.getSouthWest();
				smalllat=sw.lat().toPrecision(5);//-38.973;
				smalllng=sw.lng().toPrecision(5);//144.686;
				biglat=ne.lat().toPrecision(5);//-37.848;
				biglng=ne.lng().toPrecision(5);//145.36;
				if(document.getElementById('rwe').checked) {
						$.ajax({
							url: "vicapirwe.php",
							type: 'GET',
					 		data: {lat1:smalllat,lng1:smalllng,lat2:biglat, lng2:biglng },
							datatype:'json',
							async: false,
							success:function(data) {
								var myArray = JSON.parse(data);
							myArray.features.forEach(function (ln){
							var coor=ln.geometry.coordinates;//0long& 1lat
							for(i=0;i<coor.length;i++)
							{  var latlng = new google.maps.LatLng(coor[i][1],coor[i][0]);
									if (coor[i][1]>=smalllat && coor[i][1]<=biglat && coor[i][0]>=smalllng && coor[i][0]>=biglng){
										LatLngrwes.push(latlng);}
									}})
								},
							error:function(){ throw error;}
						});//	var imaage="./images/info.png";
						if (LatLngercs.length==0){
							alert("No close road!")}
							else{
								var flightPath = new google.maps.Polyline({
									path: LatLngrwes,
									geodesic: true,
									strokeColor: '#FF0000',
									strokeOpacity: 1.0,
									strokeWeight: 2
						});
									flightPath.setMap(map);
	}
}
						if(document.getElementById('erc').checked) {
								$.ajax({
									url: "vicapierc.php",
									type: 'GET',
							 		data: {lati1:smalllat,lngi1:smalllng,lati2:biglat, lngi2:biglng },
									datatype:'json',
									async: false,
									success:function(data) {
										  console.log(data);
										  var myArray = JSON.parse(data);
											myArray.features.forEach(function (ln){
											var lng=ln.geometry.coordinates[0];//0long& 1lat
											var lat=ln.geometry.coordinates[1];
											var latlng = new google.maps.LatLng(lat,lng);
											LatLngrwes.push(latlng);
										})
									},
									error:function(){ throw error;}});
			//						var imaage="./images/beachflag.png";
			//						LatLngrwes.forEach(function(LatLngrwe) {
			//								var marker = new google.maps.Marker({
			//											position: LatLngrwe,
			//											icon: imaage,
			//											map: map});
			//											markers.push(marker);
			//					});
			}
			if(document.getElementById('pra').checked) {
					$.ajax({
						url: "weasug.php",
						type: 'GET',
						data: {lng1:smalllng,lat1:smalllat,lng2:biglng,lat2:biglat},
						datatype:'json',
						async: false,
						success:function(data) {
								console.log(data);
								var myArray = JSON.parse(data);
								myArray.forEach(function (ln){
								var lng=ln.LONGITUDE;//0long& 1lat
								var lat=ln.LATITUDE;
								var latlng = new google.maps.LatLng(lat,lng);
								acciMarkers.push(latlng);
							})
						},
						error:function(){ throw error;}});
						$.ajax({
							url: "park.php",
							type: 'GET',
							data: {lng1:smalllng,lat1:smalllat,lng2:biglng,lat2:biglat},
							datatype:'json',
							async: false,
							success:function(data) {
									console.log(data);
									console.log(acciMarkers.length);
									var myArray = JSON.parse(data);
									myArray.forEach(function (ln){
									var lng=ln.LONGITUDE;//0long& 1lat
									var lat=ln.LATITUDE;
									var latlng = new google.maps.LatLng(lat,lng);
									for(i=0;i<acciMarkers.length;i++)
									{  if (Math.abs(acciMarkers[i].lat()-latlng.lat())>0.00008 && Math.abs(acciMarkers[i].lng()-latlng.lng())>0.00008
									) {
												park.push(latlng);
											}
											}
											console.log(park);
								})
							},
							error:function(){ throw error;}});
							var imaage="./images/beachflag.png";
							park.forEach(function(par) {
							var marker = new google.maps.Marker({
										position: par,
										icon: imaage,
							  		map: map});
										markers.push(marker);
							});
}

	}
	else{
		alert("No such address;")
	}
}
}
function clearMarkers() {
	for (var i = 0; i < markers.length; i++) {
          markers[i].setMap(null);
	}
  markers = [];
	LatLngercs=[];
	LatLngrwes=[];
}
	</script>


		<footer id="footer">
			<!-- .footer start -->
			<div class="footer">
				<div class ="col-md-6">
					<div class="col-md-6">
						<h3 style="color:black">FIND US</h3>
						<blockquote style="color: navy">
							<p>Address</p>
							<p>900 Dandenong Rd, Caulfield East</p>
							<p>Melbourne,VIC 3145</p>
						</blockquote>
					</div>
					<div class="col-md-6">
						<h3 style="color:black">ABOUT THIS WEBSITE</h3>
						<blockquote style="color: navy">
							<p>We aim to spread awareness of the</p>
							<p>importance of Road Safety among the</p>
							<p>young drivers and help them be better</p>
							<p>informed when on the road.</p>
						</blockquote>
					</div>
				</div>
				<div class ="col-md-6">
					<div class="col-md-6">
						<h3 style="color:black">SEARCH</h3>
					</div>
					<div class="col-md-6">
						<h3 style="color:black">DATA SOUCE</h3>
						<blockquote style="color: navy">
							<p>GOVERNMENT OF VICTORIA</p>
							<p>VICROADS</p>
							<p>OPENWEATHERMAP</p>
						</blockquote>
					</div>
				</div>
			<!-- ================ -->
		<div class="subfooter">
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<p class="text-center">@Team Jetsons</p>
					</div>
				</div>
			</div>
		</div>
			</div>
		</div>
		<!-- .subfooter end -->
	</footer>
	<!-- footer end -->

		<!-- JavaScript files placed at the end of the document so the pages load faster
		================================================== -->
		<!-- Jquery and Bootstap core js files -->
		<script type="text/javascript" src="plugins/jquery.min.js"></script>
		<script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>

		<!-- Modernizr javascript -->
		<script type="text/javascript" src="plugins/modernizr.js"></script>

		<!-- Isotope javascript -->
		<script type="text/javascript" src="plugins/isotope/isotope.pkgd.min.js"></script>

		<!-- Backstretch javascript -->
		<script type="text/javascript" src="plugins/jquery.backstretch.min.js"></script>

		<!-- Appear javascript -->
		<script type="text/javascript" src="plugins/jquery.appear.js"></script>

		<!-- Initialization of Plugins -->
		<script type="text/javascript" src="js/template.js"></script>

		<!-- Custom Scripts -->
		<script type="text/javascript" src="js/custom.js"></script>

	</body>
</html>
